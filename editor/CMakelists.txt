include(FetchContent)

# ImGui
FetchContent_Declare(imgui
                     GIT_REPOSITORY https://github.com/ocornut/imgui.git
                     GIT_TAG docking # branch name
)
FetchContent_MakeAvailable(imgui)

set(IMGUI_SOURCE_FILES ${imgui_SOURCE_DIR}/imgui.cpp
                       ${imgui_SOURCE_DIR}/imgui_demo.cpp
                       ${imgui_SOURCE_DIR}/imgui_draw.cpp
                       ${imgui_SOURCE_DIR}/imgui_tables.cpp
                       ${imgui_SOURCE_DIR}/imgui_widgets.cpp
                       ${imgui_SOURCE_DIR}/backends/imgui_impl_sdl.cpp
                       ${imgui_SOURCE_DIR}/backends/imgui_impl_opengl3.cpp
)

add_executable(EditorFrakkas
			   ${PROJECT_SOURCE_DIR}/appicon.rc
               src/main.cpp
               ${PROJECT_SOURCE_DIR}/lib/glad.c
               ${IMGUI_SOURCE_FILES}
               src/editor_render.cpp
               src/hierarchy.cpp
               src/menu_bar.cpp
               src/file_browser.cpp
        	   src/console.cpp
			   src/inspector.cpp
			   src/scene.cpp
			   src/game.cpp
)

target_link_libraries(EditorFrakkas
                      PRIVATE EngineFrakkas
                      PRIVATE SDL2-static
)

target_include_directories(EditorFrakkas
                           PRIVATE include
						   PRIVATE ${PROJECT_SOURCE_DIR}/common/include
                           PRIVATE ${PROJECT_SOURCE_DIR}/engine/include
                           PRIVATE ${PROJECT_SOURCE_DIR}/maths/include
                           PRIVATE ${PROJECT_SOURCE_DIR}/maths/inline
                           PRIVATE ${PROJECT_SOURCE_DIR}/lib
                           PRIVATE ${imgui_SOURCE_DIR}
                           PRIVATE ${imgui_SOURCE_DIR}/backends
                           PRIVATE ${PROJECT_SOURCE_DIR}/maths/include
                           PRIVATE ${PROJECT_SOURCE_DIR}/maths/inline
)

set_target_properties(EditorFrakkas PROPERTIES
					  RUNTIME_OUTPUT_DIRECTORY_DEBUG ${PROJECT_SOURCE_DIR}/build/debug
					  RUNTIME_OUTPUT_DIRECTORY_RELEASE ${PROJECT_SOURCE_DIR}/build/release
					  VS_DEBUGGER_WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
)

add_custom_command(TARGET EditorFrakkas POST_BUILD
		 		   COMMAND ${CMAKE_COMMAND} ARGS -E copy_directory
				   ${PROJECT_SOURCE_DIR}/editor/assets
		 		   ${PROJECT_SOURCE_DIR}/build/debug/editor/assets
				   COMMAND ${CMAKE_COMMAND} -E copy
				   ${PROJECT_SOURCE_DIR}/imgui.ini
				   ${PROJECT_SOURCE_DIR}/build/debug

				   COMMAND ${CMAKE_COMMAND} ARGS -E copy_directory
				   ${PROJECT_SOURCE_DIR}/editor/assets
				   ${PROJECT_SOURCE_DIR}/build/release/editor/assets
				   COMMAND ${CMAKE_COMMAND} -E copy
				   ${PROJECT_SOURCE_DIR}/imgui.ini
				   ${PROJECT_SOURCE_DIR}/build/release
)